-- int__spg_subgroup_wide.sql
-- intermediate dbt data model / table that turns the long version of subgroup spg grades into a wide version

SELECT
  reporting_year_use,
  lea_use as lea,
  lea_name,
  school_code,
  school_name,
  grade_span,
  title_1,
  MAX(IF(subgroup = 'ALL', spg_grade, NULL)) AS spg_grade_ALL,
  MAX(IF(subgroup = 'ALL', spg_score, NULL)) AS spg_score_ALL,
  MAX(IF(subgroup = 'ALL', ach_score, NULL)) AS ach_score_ALL,
  MAX(IF(subgroup = 'ALL', eg_score, NULL)) AS eg_score_ALL,
  MAX(IF(subgroup = 'ALL', eg_status, NULL)) AS eg_status_ALL,
  MAX(IF(subgroup = 'ALL', eg_index, NULL)) AS eg_index_ALL,
  MAX(IF(subgroup = 'AMIN', spg_grade, NULL)) AS spg_grade_AMIN,
  MAX(IF(subgroup = 'AMIN', spg_score, NULL)) AS spg_score_AMIN,
  MAX(IF(subgroup = 'AMIN', ach_score, NULL)) AS ach_score_AMIN,
  MAX(IF(subgroup = 'AMIN', eg_score, NULL)) AS eg_score_AMIN,
  MAX(IF(subgroup = 'AMIN', eg_status, NULL)) AS eg_status_AMIN,
  MAX(IF(subgroup = 'AMIN', eg_index, NULL)) AS eg_index_AMIN,
  MAX(IF(subgroup = 'ASIA', spg_grade, NULL)) AS spg_grade_ASIA,
  MAX(IF(subgroup = 'ASIA', spg_score, NULL)) AS spg_score_ASIA,
  MAX(IF(subgroup = 'ASIA', ach_score, NULL)) AS ach_score_ASIA,
  MAX(IF(subgroup = 'ASIA', eg_score, NULL)) AS eg_score_ASIA,
  MAX(IF(subgroup = 'ASIA', eg_status, NULL)) AS eg_status_ASIA,
  MAX(IF(subgroup = 'ASIA', eg_index, NULL)) AS eg_index_ASIA,
  MAX(IF(subgroup = 'BLCK', spg_grade, NULL)) AS spg_grade_BLCK,
  MAX(IF(subgroup = 'BLCK', spg_score, NULL)) AS spg_score_BLCK,
  MAX(IF(subgroup = 'BLCK', ach_score, NULL)) AS ach_score_BLCK,
  MAX(IF(subgroup = 'BLCK', eg_score, NULL)) AS eg_score_BLCK,
  MAX(IF(subgroup = 'BLCK', eg_status, NULL)) AS eg_status_BLCK,
  MAX(IF(subgroup = 'BLCK', eg_index, NULL)) AS eg_index_BLCK,
  MAX(IF(subgroup = 'HISP', spg_grade, NULL)) AS spg_grade_HISP,
  MAX(IF(subgroup = 'HISP', spg_score, NULL)) AS spg_score_HISP,
  MAX(IF(subgroup = 'HISP', ach_score, NULL)) AS ach_score_HISP,
  MAX(IF(subgroup = 'HISP', eg_score, NULL)) AS eg_score_HISP,
  MAX(IF(subgroup = 'HISP', eg_status, NULL)) AS eg_status_HISP,
  MAX(IF(subgroup = 'HISP', eg_index, NULL)) AS eg_index_HISP,
  MAX(IF(subgroup = 'MULT', spg_grade, NULL)) AS spg_grade_MULT,
  MAX(IF(subgroup = 'MULT', spg_score, NULL)) AS spg_score_MULT,
  MAX(IF(subgroup = 'MULT', ach_score, NULL)) AS ach_score_MULT,
  MAX(IF(subgroup = 'MULT', eg_score, NULL)) AS eg_score_MULT,
  MAX(IF(subgroup = 'MULT', eg_status, NULL)) AS eg_status_MULT,
  MAX(IF(subgroup = 'MULT', eg_index, NULL)) AS eg_index_MULT,
  MAX(IF(subgroup = 'WHTE', spg_grade, NULL)) AS spg_grade_WHTE,
  MAX(IF(subgroup = 'WHTE', spg_score, NULL)) AS spg_score_WHTE,
  MAX(IF(subgroup = 'WHTE', ach_score, NULL)) AS ach_score_WHTE,
  MAX(IF(subgroup = 'WHTE', eg_score, NULL)) AS eg_score_WHTE,
  MAX(IF(subgroup = 'WHTE', eg_status, NULL)) AS eg_status_WHTE,
  MAX(IF(subgroup = 'WHTE', eg_index, NULL)) AS eg_index_WHTE,
  MAX(IF(subgroup = 'EDS', spg_grade, NULL)) AS spg_grade_EDS,
  MAX(IF(subgroup = 'EDS', spg_score, NULL)) AS spg_score_EDS,
  MAX(IF(subgroup = 'EDS', ach_score, NULL)) AS ach_score_EDS,
  MAX(IF(subgroup = 'EDS', eg_score, NULL)) AS eg_score_EDS,
  MAX(IF(subgroup = 'EDS', eg_status, NULL)) AS eg_status_EDS,
  MAX(IF(subgroup = 'EDS', eg_index, NULL)) AS eg_index_EDS,
  MAX(IF(subgroup = 'ELS', spg_grade, NULL)) AS spg_grade_ELS,
  MAX(IF(subgroup = 'ELS', spg_score, NULL)) AS spg_score_ELS,
  MAX(IF(subgroup = 'ELS', ach_score, NULL)) AS ach_score_ELS,
  MAX(IF(subgroup = 'ELS', eg_score, NULL)) AS eg_score_ELS,
  MAX(IF(subgroup = 'ELS', eg_status, NULL)) AS eg_status_ELS,
  MAX(IF(subgroup = 'ELS', eg_index, NULL)) AS eg_index_ELS,
  MAX(IF(subgroup = 'SWD', spg_grade, NULL)) AS spg_grade_SWD,
  MAX(IF(subgroup = 'SWD', spg_score, NULL)) AS spg_score_SWD,
  MAX(IF(subgroup = 'SWD', ach_score, NULL)) AS ach_score_SWD,
  MAX(IF(subgroup = 'SWD', eg_score, NULL)) AS eg_score_SWD,
  MAX(IF(subgroup = 'SWD', eg_status, NULL)) AS eg_status_SWD,
  MAX(IF(subgroup = 'SWD', eg_index, NULL)) AS eg_index_SWD,
  MAX(IF(subgroup = 'ALL', rd_spg_grade, NULL)) AS rd_spg_grade_ALL,
  MAX(IF(subgroup = 'ALL', rd_spg_score, NULL)) AS rd_spg_score_ALL,
  MAX(IF(subgroup = 'ALL', rdgs_ach_score, NULL)) AS rdgs_ach_score_ALL,
  MAX(IF(subgroup = 'ALL', rd_eg_score, NULL)) AS rd_eg_score_ALL,
  MAX(IF(subgroup = 'ALL', rd_eg_status, NULL)) AS rd_eg_status_ALL,
  MAX(IF(subgroup = 'ALL', rd_eg_index, NULL)) AS rd_eg_index_ALL,
  MAX(IF(subgroup = 'AMIN', rd_spg_grade, NULL)) AS rd_spg_grade_AMIN,
  MAX(IF(subgroup = 'AMIN', rd_spg_score, NULL)) AS rd_spg_score_AMIN,
  MAX(IF(subgroup = 'AMIN', rdgs_ach_score, NULL)) AS rdgs_ach_score_AMIN,
  MAX(IF(subgroup = 'AMIN', rd_eg_score, NULL)) AS rd_eg_score_AMIN,
  MAX(IF(subgroup = 'AMIN', rd_eg_status, NULL)) AS rd_eg_status_AMIN,
  MAX(IF(subgroup = 'AMIN', rd_eg_index, NULL)) AS rd_eg_index_AMIN,
  MAX(IF(subgroup = 'ASIA', rd_spg_grade, NULL)) AS rd_spg_grade_ASIA,
  MAX(IF(subgroup = 'ASIA', rd_spg_score, NULL)) AS rd_spg_score_ASIA,
  MAX(IF(subgroup = 'ASIA', rdgs_ach_score, NULL)) AS rdgs_ach_score_ASIA,
  MAX(IF(subgroup = 'ASIA', rd_eg_score, NULL)) AS rd_eg_score_ASIA,
  MAX(IF(subgroup = 'ASIA', rd_eg_status, NULL)) AS rd_eg_status_ASIA,
  MAX(IF(subgroup = 'ASIA', rd_eg_index, NULL)) AS rd_eg_index_ASIA,
  MAX(IF(subgroup = 'BLCK', rd_spg_grade, NULL)) AS rd_spg_grade_BLCK,
  MAX(IF(subgroup = 'BLCK', rd_spg_score, NULL)) AS rd_spg_score_BLCK,
  MAX(IF(subgroup = 'BLCK', rdgs_ach_score, NULL)) AS rdgs_ach_score_BLCK,
  MAX(IF(subgroup = 'BLCK', rd_eg_score, NULL)) AS rd_eg_score_BLCK,
  MAX(IF(subgroup = 'BLCK', rd_eg_status, NULL)) AS rd_eg_status_BLCK,
  MAX(IF(subgroup = 'BLCK', rd_eg_index, NULL)) AS rd_eg_index_BLCK,
  MAX(IF(subgroup = 'HISP', rd_spg_grade, NULL)) AS rd_spg_grade_HISP,
  MAX(IF(subgroup = 'HISP', rd_spg_score, NULL)) AS rd_spg_score_HISP,
  MAX(IF(subgroup = 'HISP', rdgs_ach_score, NULL)) AS rdgs_ach_score_HISP,
  MAX(IF(subgroup = 'HISP', rd_eg_score, NULL)) AS rd_eg_score_HISP,
  MAX(IF(subgroup = 'HISP', rd_eg_status, NULL)) AS rd_eg_status_HISP,
  MAX(IF(subgroup = 'HISP', rd_eg_index, NULL)) AS rd_eg_index_HISP,
  MAX(IF(subgroup = 'MULT', rd_spg_grade, NULL)) AS rd_spg_grade_MULT,
  MAX(IF(subgroup = 'MULT', rd_spg_score, NULL)) AS rd_spg_score_MULT,
  MAX(IF(subgroup = 'MULT', rdgs_ach_score, NULL)) AS rdgs_ach_score_MULT,
  MAX(IF(subgroup = 'MULT', rd_eg_score, NULL)) AS rd_eg_score_MULT,
  MAX(IF(subgroup = 'MULT', rd_eg_status, NULL)) AS rd_eg_status_MULT,
  MAX(IF(subgroup = 'MULT', rd_eg_index, NULL)) AS rd_eg_index_MULT,
  MAX(IF(subgroup = 'WHTE', rd_spg_grade, NULL)) AS rd_spg_grade_WHTE,
  MAX(IF(subgroup = 'WHTE', rd_spg_score, NULL)) AS rd_spg_score_WHTE,
  MAX(IF(subgroup = 'WHTE', rdgs_ach_score, NULL)) AS rdgs_ach_score_WHTE,
  MAX(IF(subgroup = 'WHTE', rd_eg_score, NULL)) AS rd_eg_score_WHTE,
  MAX(IF(subgroup = 'WHTE', rd_eg_status, NULL)) AS rd_eg_status_WHTE,
  MAX(IF(subgroup = 'WHTE', rd_eg_index, NULL)) AS rd_eg_index_WHTE,
  MAX(IF(subgroup = 'ALL', ma_spg_grade, NULL)) AS ma_spg_grade_ALL,
  MAX(IF(subgroup = 'ALL', ma_spg_score, NULL)) AS ma_spg_score_ALL,
  MAX(IF(subgroup = 'ALL', mags_ach_score, NULL)) AS mags_ach_score_ALL,
  MAX(IF(subgroup = 'ALL', ma_eg_score, NULL)) AS ma_eg_score_ALL,
  MAX(IF(subgroup = 'ALL', ma_eg_status, NULL)) AS ma_eg_status_ALL,
  MAX(IF(subgroup = 'ALL', ma_eg_index, NULL)) AS ma_eg_index_ALL,
  MAX(IF(subgroup = 'AMIN', ma_spg_grade, NULL)) AS ma_spg_grade_AMIN,
  MAX(IF(subgroup = 'AMIN', ma_spg_score, NULL)) AS ma_spg_score_AMIN,
  MAX(IF(subgroup = 'AMIN', mags_ach_score, NULL)) AS mags_ach_score_AMIN,
  MAX(IF(subgroup = 'AMIN', ma_eg_score, NULL)) AS ma_eg_score_AMIN,
  MAX(IF(subgroup = 'AMIN', ma_eg_status, NULL)) AS ma_eg_status_AMIN,
  MAX(IF(subgroup = 'AMIN', ma_eg_index, NULL)) AS ma_eg_index_AMIN,
  MAX(IF(subgroup = 'ASIA', ma_spg_grade, NULL)) AS ma_spg_grade_ASIA,
  MAX(IF(subgroup = 'ASIA', ma_spg_score, NULL)) AS ma_spg_score_ASIA,
  MAX(IF(subgroup = 'ASIA', mags_ach_score, NULL)) AS mags_ach_score_ASIA,
  MAX(IF(subgroup = 'ASIA', ma_eg_score, NULL)) AS ma_eg_score_ASIA,
  MAX(IF(subgroup = 'ASIA', ma_eg_status, NULL)) AS ma_eg_status_ASIA,
  MAX(IF(subgroup = 'ASIA', ma_eg_index, NULL)) AS ma_eg_index_ASIA,
  MAX(IF(subgroup = 'BLCK', ma_spg_grade, NULL)) AS ma_spg_grade_BLCK,
  MAX(IF(subgroup = 'BLCK', ma_spg_score, NULL)) AS ma_spg_score_BLCK,
  MAX(IF(subgroup = 'BLCK', mags_ach_score, NULL)) AS mags_ach_score_BLCK,
  MAX(IF(subgroup = 'BLCK', ma_eg_score, NULL)) AS ma_eg_score_BLCK,
  MAX(IF(subgroup = 'BLCK', ma_eg_status, NULL)) AS ma_eg_status_BLCK,
  MAX(IF(subgroup = 'BLCK', ma_eg_index, NULL)) AS ma_eg_index_BLCK,
  MAX(IF(subgroup = 'HISP', ma_spg_grade, NULL)) AS ma_spg_grade_HISP,
  MAX(IF(subgroup = 'HISP', ma_spg_score, NULL)) AS ma_spg_score_HISP,
  MAX(IF(subgroup = 'HISP', mags_ach_score, NULL)) AS mags_ach_score_HISP,
  MAX(IF(subgroup = 'HISP', ma_eg_score, NULL)) AS ma_eg_score_HISP,
  MAX(IF(subgroup = 'HISP', ma_eg_status, NULL)) AS ma_eg_status_HISP,
  MAX(IF(subgroup = 'HISP', ma_eg_index, NULL)) AS ma_eg_index_HISP,
  MAX(IF(subgroup = 'MULT', ma_spg_grade, NULL)) AS ma_spg_grade_MULT,
  MAX(IF(subgroup = 'MULT', ma_spg_score, NULL)) AS ma_spg_score_MULT,
  MAX(IF(subgroup = 'MULT', mags_ach_score, NULL)) AS mags_ach_score_MULT,
  MAX(IF(subgroup = 'MULT', ma_eg_score, NULL)) AS ma_eg_score_MULT,
  MAX(IF(subgroup = 'MULT', ma_eg_status, NULL)) AS ma_eg_status_MULT,
  MAX(IF(subgroup = 'MULT', ma_eg_index, NULL)) AS ma_eg_index_MULT,
  MAX(IF(subgroup = 'WHTE', ma_spg_grade, NULL)) AS ma_spg_grade_WHTE,
  MAX(IF(subgroup = 'WHTE', ma_spg_score, NULL)) AS ma_spg_score_WHTE,
  MAX(IF(subgroup = 'WHTE', mags_ach_score, NULL)) AS mags_ach_score_WHTE,
  MAX(IF(subgroup = 'WHTE', ma_eg_score, NULL)) AS ma_eg_score_WHTE,
  MAX(IF(subgroup = 'WHTE', ma_eg_status, NULL)) AS ma_eg_status_WHTE,
  MAX(IF(subgroup = 'WHTE', ma_eg_index, NULL)) AS ma_eg_index_WHTE,
  MAX(IF(subgroup = 'EDS', ma_spg_grade, NULL)) AS ma_spg_grade_EDS,
  MAX(IF(subgroup = 'EDS', ma_spg_score, NULL)) AS ma_spg_score_EDS,
  MAX(IF(subgroup = 'EDS', mags_ach_score, NULL)) AS mags_ach_score_EDS,
  MAX(IF(subgroup = 'EDS', ma_eg_score, NULL)) AS ma_eg_score_EDS,
  MAX(IF(subgroup = 'EDS', ma_eg_status, NULL)) AS ma_eg_status_EDS,
  MAX(IF(subgroup = 'EDS', ma_eg_index, NULL)) AS ma_eg_index_EDS,
  MAX(IF(subgroup = 'ELS', ma_spg_grade, NULL)) AS ma_spg_grade_ELS,
  MAX(IF(subgroup = 'ELS', ma_spg_score, NULL)) AS ma_spg_score_ELS,
  MAX(IF(subgroup = 'ELS', mags_ach_score, NULL)) AS mags_ach_score_ELS,
  MAX(IF(subgroup = 'ELS', ma_eg_score, NULL)) AS ma_eg_score_ELS,
  MAX(IF(subgroup = 'ELS', ma_eg_status, NULL)) AS ma_eg_status_ELS,
  MAX(IF(subgroup = 'ELS', ma_eg_index, NULL)) AS ma_eg_index_ELS,
  MAX(IF(subgroup = 'SWD', ma_spg_grade, NULL)) AS ma_spg_grade_SWD,
  MAX(IF(subgroup = 'SWD', ma_spg_score, NULL)) AS ma_spg_score_SWD,
  MAX(IF(subgroup = 'SWD', mags_ach_score, NULL)) AS mags_ach_score_SWD,
  MAX(IF(subgroup = 'SWD', ma_eg_score, NULL)) AS ma_eg_score_SWD,
  MAX(IF(subgroup = 'SWD', ma_eg_status, NULL)) AS ma_eg_status_SWD,
  MAX(IF(subgroup = 'SWD', ma_eg_index, NULL)) AS ma_eg_index_SWD
FROM {{ ref('stg__spg_subgroup') }}
GROUP BY
  reporting_year_use,
  lea_use,
  lea_name,
  school_code,
  school_name,
  grade_span,
  title_1